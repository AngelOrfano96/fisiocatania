<table id="tabellaGiocatori" class="table table-bordered table-striped align-middle">
  <thead>
    <tr>
      <th>Anagrafica</th>
      <th>Data Nascita</th>
      <th>Comune di Nascita</th>
      <th>Cellulare</th>
      <th>Note</th>
      <th>Modifica</th>
      <th>Elimina</th>
    </tr>
  </thead>
  <tbody>
    <% giocatori.forEach(g => { %>
      <tr data-id="<%= g.id %>">
        <form class="edit-form" method="POST" action="/anagrafica/update/<%= g.id %>">
          <td>
            <span class="static nome"><%= g.nome %></span>
            <input name="nome" class="form-control form-control-sm d-none" value="<%= g.nome %>">

            <span class="static cognome d-block"><%= g.cognome %></span>
            <input name="cognome" class="form-control form-control-sm d-none mt-1" value="<%= g.cognome %>">
          </td>
          <td>
            <span class="static"><%= g.data_nascita.toISOString().split('T')[0] %></span>
            <input name="data_nascita" type="date" class="form-control form-control-sm d-none" value="<%= g.data_nascita.toISOString().split('T')[0] %>">
          </td>
          <td>
            <span class="static"><%= g.luogo_nascita %></span>
            <input name="luogo_nascita" class="form-control form-control-sm d-none" value="<%= g.luogo_nascita %>">
          </td>
          <td>
            <span class="static"><%= g.cellulare %></span>
            <input name="cellulare" class="form-control form-control-sm d-none" value="<%= g.cellulare %>">
          </td>
          <td>
            <span class="static"><%= g.note %></span>
            <textarea name="note" class="form-control form-control-sm d-none"><%= g.note %></textarea>
          </td>
          <td>
            <button type="button" class="btn btn-sm btn-warning btn-edit">‚úèÔ∏è</button>
            <button type="submit" class="btn btn-sm btn-success d-none btn-save">üíæ</button>
            <button type="button" class="btn btn-sm btn-secondary d-none btn-cancel">‚Ü©Ô∏è</button>
          </td>
          <td>
            <button type="submit" formaction="/anagrafica/delete/<%= g.id %>" formmethod="POST" class="btn btn-sm btn-danger" onclick="return confirm('Confermi l\'eliminazione?')">üóëÔ∏è</button>
          </td>
        </form>
      </tr>
    <% }) %>
  </tbody>
</table>

<style>
  td span.static {
    display: inline-block;
    width: 100%;
    padding: 4px 6px;
    background-color: transparent;
    border-radius: 4px;
  }
</style>

<script>
  $(document).ready(function () {
    $('#tabellaGiocatori').DataTable({
      pageLength: 10,
      lengthMenu: [5, 10, 20, 50],
      language: {
        url: '//cdn.datatables.net/plug-ins/1.13.6/i18n/it-IT.json'
      },
      columnDefs: [{ orderable: false, targets: [5, 6] }]
    });

    $('.btn-edit').click(function () {
      const form = $(this).closest('form');
      form.find('span.static').addClass('d-none');
      form.find('input, textarea').removeClass('d-none');
      form.find('.btn-edit').addClass('d-none');
      form.find('.btn-save, .btn-cancel').removeClass('d-none');
    });

    $('.btn-cancel').click(function () {
      location.reload(); // Annulla e ripristina
    });
  });
</script>
